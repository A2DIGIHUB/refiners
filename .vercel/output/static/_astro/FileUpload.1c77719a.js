import{j as e,u as $,g as F}from"./supabase.52e742a7.js";import{r as n}from"./index.b2a7ed32.js";function C({bucket:o,path:g,allowedTypes:l=["image/jpeg","image/png","image/webp"],maxSize:t=50*1024*1024,multiple:i=!1,onUploadComplete:j,onError:c}){const[d,m]=n.useState(!1),[y,p]=n.useState({}),b=n.useCallback(s=>l.includes(s.type)?s.size>t?`File ${s.name} is too large. Maximum size: ${t/1024/1024}MB`:null:`Invalid file type for ${s.name}. Allowed types: ${l.join(", ")}`,[l,t]),N=async s=>{const r=Array.from(s.target.files||[]);if(r.length===0)return;const f=r.map(b).filter(Boolean);if(f.length>0){c(f.join(`
`));return}m(!0);const u=[];try{await Promise.all(r.map(async a=>{const{data:h,error:x}=await $(o,g,a,v=>{p(U=>({...U,[a.name]:v}))});if(x)throw x;if(!h)throw new Error(`Upload failed for ${a.name}`);const w=F(o,h.path);u.push(w)})),j(u)}catch(a){c(a instanceof Error?a.message:"Upload failed")}finally{m(!1),p({})}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"sr-only",children:["Choose file",i?"s":""]}),e.jsx("input",{type:"file",className:`block w-full text-sm text-primary-500
              file:mr-4 file:py-2 file:px-4
              file:rounded-full file:border-0
              file:text-sm file:font-semibold
              file:bg-primary-50 file:text-primary-700
              hover:file:bg-primary-100
              disabled:opacity-50 disabled:cursor-not-allowed`,onChange:N,accept:l.join(","),multiple:i,disabled:d})]}),d&&Object.entries(y).map(([s,r])=>e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-sm text-primary-600 mb-1",children:[e.jsx("span",{className:"truncate",children:s}),e.jsxs("span",{children:[Math.round(r),"%"]})]}),e.jsx("div",{className:"w-full bg-primary-100 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]},s))]}),e.jsx("p",{className:"mt-2 text-sm text-primary-600",children:i?"Drop files here or click to upload":"Drop a file here or click to upload"}),e.jsxs("p",{className:"text-xs text-primary-500",children:["Maximum file size: ",t/1024/1024,"MB"]})]})}export{C as FileUpload};
